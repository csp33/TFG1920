\documentclass[12pt,english]{article}
\usepackage[a4paper,left=3cm,right=2cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{graphicx}
\usepackage{pifont}
\usepackage{color}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{amsthm,thmtools}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{url}
\usepackage{multirow}
\usepackage[hidelinks]{hyperref}
\usepackage{caption}
\usepackage{apacite}
\usepackage{amsthm}
\usepackage{multicol}
\usepackage{float}
\usepackage{amsfonts}
\usepackage[usestackEOL]{stackengine}
\usepackage{titling}
\usepackage{soul}
\usepackage{pgfplots}
\usepackage[nottoc]{tocbibind}
\usepackage{listings}
\usepackage{array}
\usepackage[framemethod=tikz]{mdframed}
\usepackage{footnote}
\makesavenoteenv{tabular}
\makesavenoteenv{table}
\newcommand{\greentick}{\textcolor{green}{\ding{52}}}
\newcommand{\redcross}{\textcolor{red}{\ding{55}}}
\graphicspath{ {./img/}}
\makeatletter
\def\input@path{{input/}}
\makeatother
\selectlanguage{english}


\lstset{
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}


\makeindex

\definecolor{light-gray}{gray}{0.95}
\lstset{columns=fullflexible,basicstyle=\ttfamily}
\surroundwithmdframed[
  hidealllines=true,
  backgroundcolor=light-gray,
  innerleftmargin=0pt,
  innertopmargin=0pt,
  innerbottommargin=0pt]{lstlisting}

\pgfplotsset{width=8cm,compat=1.9, xlabel={Year},
  ylabel={Number of documents}, xtick distance={2},
  ytick distance={2}, ymajorgrids=true,grid style=dashed,
  /pgf/number format/.cd,use comma,1000 sep={}}


\begin{document}

\input{titlepage.tex}
\input{preface.tex}
\thispagestyle{empty}
\newpage
\tableofcontents{}
\newpage
%\listoffigures
%\thispagestyle{empty}
%\newpage

\section{Introduction}

\subsection{Context}

Mental disorders are very common in our society. According to \cite{Bandelow2015}, almost 34\% of the population suffer from anxiety at least once in their lives. They are difficult to be diagnosed and properly treated. Most intervention programs do not last as much as they should and doctors have a very high workload, so patients need to wait for a long time before being advised by a doctor. In addition, although having a mental disease is very common, it is still a taboo subject whose stigma makes them even more difficult to be diagnosed and treated, as \cite{Davies2000} states.\\

In addition, people do not go to the doctor every time something happens, so there is not a continuous traceability of patients' health status. This causes a lot of relevant data not to be retrieved. This data could be suitable to perform more specific and personal medical analysis. Having a coach that regularly interacts with the person with a mental disorder as well as extracts data from his or her responses would take advantage of this information.


\subsection{Motivation}

Nowadays, technology is becoming increasingly integrated in our lives. Specifically, smartphones have became a daily basis used tool. People read the news, check the weather, chat with their relatives and friends, etc. using smartphones. Modern chat applications (such as \cite{Telegram} allow people to create bots that can interact with them like if there was a person on the other side. These chatbots are increasingly becoming popular amongst people because they cover many functionalities, from tracking shipments to playing games and reminding stuff. Telegram bots do not require another app to be installed in the client's phone, so the client can save storage space is saved.\\

As we previously discussed, mental disorders are taboo, so having a bot you could talk with about how was your day, feelings, etc. could lead to an easier way of diagnosing them because chat conversations are seen as ''natural'' by society. In addition, the bot would chat with the patient in a natural way thanks to Natural Language Processing. This will help the person with a mental disorder not to consider the coach a doctor, making easier to tell it how he or she feels.

\newpage

\subsection{Objectives}

\begin{itemize}
  \item \textbf{Main goal}: to develop a conversational agent as a sensor which will be able to interact with a person with a mental disorder in a natural way and analise his or her behaviour. This virtual assistant will retrieve data from the subject's attitude and responses and generate a report with this information.
  \item \textbf{Secondary goals}:
    \begin{itemize}
      \item To design a flexible and scalable architecture to add functionality to the conversational agent.
      \item To design an architecture based on containers to host the different chatbot modules.
      \item To implement a conversational agent that covers the previous goals.
      \item To test a beta version of the assistant in real people and analyse the retrieved data as well as target audience's feelings about it.
    \end{itemize}
\end{itemize}

\subsection{Structure}
\textcolor{red}{FIX EN QUÉ SE DIVIDE ESTADO DEL ARTE CUANDO ESTÉ TERMINADO}

The first chapter of this project offers an introduction to the context in which the main goal is intended to be developed. That section also contains an analysis of related papers. This analysis is divided into three main categories (health domains, dialogue and architecture) and a research about the popularity of chatbots.\\

The second one (\textbf{Methodology}) contains the proper requisites design. architecture, programming language and frameworks that are intended to be used in the chatbot development, as well as its the most important modules and some code snippets to illustrate its functionality.\\

The third one, \textbf{Evaluation}, shows the results of the chatbot testing amongst real people and the obtained results in an objective way.\\

The fourth chapter, \textbf{Discussion}, analyses the results obtained in the third chapter.\\

Finally, the last one, \textbf{Conclussions} analyses the initial objectives of the project and if they were achieved or not.



\newpage

\section{State of the art}

\subsection{Health domains}

Chatbots can be applied to many health domains. For example, \cite{Alesanco2017185} proposes an agent that provides help to perform dermatological medicament prescriptions. \cite{BennetPraba20193470} takes care about nutrition by proposing a chatbot to motivate patients to maintain weight. Another example of conversational interface oriented to health is \cite{Falala-Sechet2019236}. This paper is about establishing a dialogue with patients to help them go through difficult situations that can affect their psychological status.\\

Chat agents can not only be classified according to the area they area applied to, but also according to the objective public. We can distinguish chatbots to help students learn, such as \cite{Lopez2008194} proposal, that offers a simulation of a real patient that presents several symptoms so that students have to interview it and make a diagnostic as a doctor would do in real life. Other interesting project is \cite{Shorey2019e14658}, that intends to improve communication between patients and hospital workers by making virtual patients simulate clinical scenarios so that undergraduates could practise with real situations instead of standard ones.\\

There are also chatbots aimed to help doctors do their work. For example, \cite{Ni201738} offers an agent that interviews sick people before the doctor does. Mandy elaborates a diagnostic based on several questions about patients symptoms and sends it to the doctor so that he can save that time. As professional treatments do not last as much, complements such as \cite{DAlfonso2017} are used. They offer a long-term treatment after the professional one so that the patient's progress is not lost. \\

Last but not least, virtual agents can be aimed to help patients. For example, \cite{Harilal2020349} is a counsellor that helps patients with depression by establishing empathetic conversations with them. \cite{Roca2020954} suggests an agent that offers help to people by reminding the intake of their medication, sending notifications to caregivers, providing summaries, etc.


\subsection{Dialogue}

Virtual assistants can be classified attending to their main goal. Coaches help the user to get what he wants. For example, \cite{HUDLICKA2013160} presents a coach that assists people while trying to meditate by motivating them to do it. The paper's results showed that using the agent was more effective in helping users to establish a regular meditation habit. \cite{Guo2020} offers another coach that asseses user's in their workouts to improve their postural hygiene by using wearables as sensors. Conversational agents can also be counselors (they help the user to identify and solve problems). The research carried out by \cite{Drislane2020158} proves that counselors can be really helpful when trying to reduce alcohol and drugs consumption amongst users. \cite{Yasavur2014381} suggests a virtual therapist that gives brief speech interventions (3-5 minutes) aimed to let a person's alcohol consumption up and make him or her be aware of the problem. \\

They can use different methods to communicate with their audience: text, voice or both. If we focus on speech-enabled conversational agents, we can distinguish \cite{Maharjan2019929}, which proposes a smart speaker that regularly asks its audience about their sleep quality, mood and physical activity. By analysing the given responses and their tone, volume and  intonation the agent is able to extract useful information useful for detecting markers of a possible mental ilness. In text-based chatbots, the user's input can be free (the agent will translate it to an ontology to understand it) or limited (a custom keyboard with fixed options will be shown or the agent will ask the user to enter a valid option). Finally, the most popular virtual assistants are multimodal (they both admit text and speech communication).

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{custom_keyboard.jpg}
  \caption{Example of a custom keyboard for a conversational agent}{Reprinted from https://core.telegram.org/bots}
\end{figure}


A review of each of the previous sections can be seen in \cite{Montenegro201956}.

\subsection{Technology}

After performing some research, the following table was elaborated:

\begin{table}[h!]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    \textbf{Platform} & \addstackgap{\textbf{\shortstack{Number of daily \\ active users}}} & \textbf{Free API to implement chatbots}  \\
    \hline
    \cite{FacebookMessenger} & 1.66 billion &  \greentick \\
    \hline
    \cite{Whatsapp} & 1.5 billion & \redcross \\
    \hline
    \cite{WeChat} & 1.083 billion & \greentick  \\
    \hline
    \cite{Telegram} & 0.2 billion & \greentick \\
    \hline
    \cite{Kik} & 0.015 billion & \greentick \\
    \hline
    \cite{Discord} & 0.014 billion & \greentick \\
    \hline
    \cite{Slack} & 0.012 billion &  \greentick \\
    \hline
    \cite{Viber} & 0.008 billion &  \greentick \\
    \hline
    \cite{Line} & 0.00723 billion & \greentick  \\
    \hline
  \end{tabular}
  \caption{Comparison between different chat applications (2019)}
\end{table}

\newpage

We can see that Whatsapp, which is the most used messaging app, has no free API to develop conversational agents (the one it has it oriented to business). As opposed, the rest of the widely used chat applications offer an API for programmers to build chatbots in an easy way. In this project, Telegram is the chosen app because its API provides more customization than Facebook Messenger and the audience target is Spain, whereas Wechat is mostly used in Asia. Appart from that, people with mental disorders usually don't feel confortable to talk about their problem. As Telegram offers more privacy than other chat applications, people will feel safer chatting about their ilness.

\textcolor{red}{sentimental analysis on twitter social-searcher.com}
\pgfplotsset{
    calculate offset/.code={
        \pgfkeys{/pgf/fpu=true,/pgf/fpu/output format=fixed}
        \pgfmathsetmacro\testmacro{(\pgfplotspointmeta *10^\pgfplots@data@scale@trafo@EXPONENT@y)*\pgfplots@y@veclength)}
        \pgfkeys{/pgf/fpu=false}
    },
    every node near coord/.style={
        /pgfplots/calculate offset,
        yshift=-\testmacro
    },
}
\pgfplotstableread{
0 35569 8842    134984
1 30428 4689    34077
2 32920 6207    73787
3 16462 7562    23496
4 12315 8572    16565
5 76572 19572   26030
}\dataset
\begin{tikzpicture}
\begin{axis}[ybar,
        width=15cm,
        height=8cm,
        ymin=0,
        ymax=150000,
        ylabel={Y-Label},
        xtick=data,
        xticklabels = {
            Category 1,
            Category 2,
            Category 3,
            Category 4,
            Category 5,
            Category 6
        },
        xticklabel style={yshift=-8ex},
        major x tick style = {opacity=0},
        minor x tick num = 1,
        minor tick length=2ex,
        every node near coord/.append style={
                anchor=east,
                rotate=90
        }
        ]
\addplot[draw=black,fill=black!20, nodes near coords=Data 1] table[x index=0,y index=1] \dataset; %Data1
\addplot[draw=black,fill=black!40, nodes near coords=Data 2] table[x index=0,y index=2] \dataset; %Data2
\addplot[draw=black,fill=black!60, nodes near coords=Data 3] table[x index=0,y index=3] \dataset; %Data3
\end{axis}
 \end{tikzpicture}
 % symbolic x coords={Facebook \newline Messenger, Whatsapp, WeChat, Telegram, Kik, Discord, Slack, Viber, Line}


\end{document}
\subsection{Number of publications related to chatbots}

\textcolor{red}{Última query}

Several queries were performed on \textit{scopus.com} to check the number of articles per year related to chatbots and their applications in health. The obtained results were the following ones:

\begin{figure}[H]
  \begin{subfigure}[t]{0.3\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[title=\shortstack{chatbot OR "conversational agent"}, ytick distance={100}]
        \addplot table {data/chatbot_or_ca_query_results.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  \hspace{3cm}
  \begin{subfigure}[t]{0.3\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[title=\footnotesize{\shortstack{(chatbot OR "conversational agent")\\AND\\(coach OR counselor OR assistant)}},
                   ytick distance={15}]
        \addplot table {data/chatbot_or_ca_and_coach_or_counselor_or_assistant_query_results.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}

  \vspace{1cm}

  \begin{subfigure}[t]{0.3\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[title=\footnotesize{\shortstack{(chatbot OR "conversational agent")\\AND\\(coach OR counselor OR assistant)\\AND\\health}}, ytick distance={5}]
        \addplot table {data/chatbot_or_ca_and_coach_or_counselor_or_assistant_and_health_query_results.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  \hspace{3cm}
  \begin{subfigure}[t]{0.3\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[title=Result of 'conversational agent' query, ytick distance={50}]
        \addplot table {data/conversational_agent_query_results.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  \caption{Search results of different queries performed in \textit{scopus.com}}
\end{figure}

We can observe that, in the last 5 years, all of them show a considerable increasing number of articles and papers related to virtual assistants.



\subsection{Effectiveness of health conversational agents}

Health coaches can be really helpful. For example, \cite{Breso2016297} proposes a platform to identify and provide early intervention for symptoms of depression and suicide. Its usability percentage was 75.7\% and its accuracy, 70.9\%. Another example is \cite{Hirano2017}, which offers preventive therapy for mental healthcare. The audience' mental health punctuation significantly improved after using the application. Moreover, the usage rate and the number of suggested actions carried out was high. That indicates that people found the app useful. By last, \cite{Ring2016} suggests an agent that responds to users' affective states during virtual therapy sessions. Facial expressions and voices are measured during the session. 70\% of users affirmed that they felt understood by the agent. 50\% of them stated that the agent evoked emotional responses in them during the interactions.


\section{Methodology}

\subsection{Design}

\subsection{Implementation}


\section{Evaluation}

\subsection{Experimental setup}

\subsection{Results}


\section{Discussion}

\section{Conclusions}


\newpage
\bibliographystyle{apacite}
\bibliography{refs}
\end{document}
